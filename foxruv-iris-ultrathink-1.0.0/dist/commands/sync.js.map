{"version":3,"sources":["../../src/cli/commands/sync.ts"],"names":[],"mappings":"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","file":"sync.js","sourcesContent":["import { Command } from 'commander';\nimport chalk from 'chalk';\nimport ora from 'ora';\nimport { readFile, writeFile, readdir } from 'fs/promises';\nimport { resolve, basename } from 'path';\nimport { existsSync } from 'fs';\n\ninterface SkillFile {\n  path: string;\n  name: string;\n  metadata: SkillMetadata;\n  valid: boolean;\n  errors: string[];\n}\n\ninterface SkillMetadata {\n  name: string;\n  type: string;\n  enabled: boolean;\n  description?: string;\n  [key: string]: any;\n}\n\ninterface SyncResult {\n  discovered: SkillFile[];\n  valid: number;\n  invalid: number;\n  orphaned: string[];\n  updated: boolean;\n}\n\nexport const syncCommand = new Command('sync')\n  .description('Sync skill index with file changes')\n  .option('-d, --directory <path>', 'Skills directory', './skills')\n  .option('--validate-only', 'Only validate, don\\'t update index')\n  .option('--fix', 'Attempt to fix invalid YAML frontmatter')\n  .option('-v, --verbose', 'Show detailed validation results')\n  .action(async (options) => {\n    const spinner = ora('Syncing skill index...').start();\n\n    try {\n      const skillsPath = resolve(options.directory);\n\n      if (!existsSync(skillsPath)) {\n        spinner.fail('Skills directory not found');\n        console.log(chalk.gray(`Expected: ${skillsPath}`));\n        console.log(chalk.yellow('\\nRun `ultrathink import` to create it'));\n        process.exit(1);\n      }\n\n      spinner.text = 'Scanning skills directory...';\n\n      // Scan directory for skill files\n      const skillFiles = await scanSkillsDirectory(skillsPath);\n\n      spinner.text = 'Validating YAML frontmatter...';\n\n      // Parse and validate each skill file\n      const parsedSkills: SkillFile[] = [];\n      for (const file of skillFiles) {\n        const skill = await parseSkillFile(file);\n        parsedSkills.push(skill);\n      }\n\n      const validSkills = parsedSkills.filter(s => s.valid);\n      const invalidSkills = parsedSkills.filter(s => !s.valid);\n\n      // Show validation results\n      if (options.verbose || invalidSkills.length > 0) {\n        spinner.stop();\n\n        if (invalidSkills.length > 0) {\n          console.log(chalk.yellow('\\n⚠️  Invalid skill files:'));\n          invalidSkills.forEach(skill => {\n            console.log(chalk.red(`  ✗ ${skill.name}`));\n            skill.errors.forEach(err => console.log(chalk.gray(`    - ${err}`)));\n          });\n        }\n\n        if (validSkills.length > 0 && options.verbose) {\n          console.log(chalk.green('\\n✓ Valid skill files:'));\n          validSkills.forEach(skill => {\n            console.log(chalk.gray(`  ✓ ${skill.name} (${skill.metadata.type})`));\n          });\n        }\n\n        spinner.start();\n      }\n\n      // Fix invalid files if requested\n      if (options.fix && invalidSkills.length > 0) {\n        spinner.text = 'Fixing invalid YAML frontmatter...';\n\n        for (const skill of invalidSkills) {\n          try {\n            await fixSkillFile(skill.path);\n            console.log(chalk.green(`  Fixed: ${skill.name}`));\n          } catch (error) {\n            console.log(chalk.red(`  Failed to fix: ${skill.name}`));\n          }\n        }\n      }\n\n      // Check for orphaned index entries\n      spinner.text = 'Checking for orphaned entries...';\n      const orphanedEntries = await findOrphanedEntries(skillsPath, validSkills);\n\n      // Update index if not validate-only\n      if (!options.validateOnly) {\n        spinner.text = 'Updating INDEX.md...';\n        await updateIndex(skillsPath, validSkills, orphanedEntries);\n\n        spinner.text = 'Updating CLAUDE.md...';\n        await updateClaudeConfig(skillsPath, validSkills);\n      }\n\n      const result: SyncResult = {\n        discovered: parsedSkills,\n        valid: validSkills.length,\n        invalid: invalidSkills.length,\n        orphaned: orphanedEntries,\n        updated: !options.validateOnly\n      };\n\n      spinner.succeed(chalk.green('Sync complete!'));\n\n      // Summary\n      console.log(chalk.cyan('\\nSummary:'));\n      console.log(chalk.gray(`  Total skills: ${parsedSkills.length}`));\n      console.log(chalk.gray(`  Valid: ${result.valid}`));\n      if (result.invalid > 0) {\n        console.log(chalk.yellow(`  Invalid: ${result.invalid}`));\n      }\n      if (result.orphaned.length > 0) {\n        console.log(chalk.yellow(`  Orphaned entries: ${result.orphaned.length}`));\n      }\n\n      if (options.validateOnly) {\n        console.log(chalk.yellow('\\n⚠️  Validation-only mode: No files were modified'));\n      } else {\n        console.log(chalk.green('\\n✓ INDEX.md updated'));\n        console.log(chalk.green('✓ CLAUDE.md updated'));\n      }\n\n      if (result.invalid > 0) {\n        console.log(chalk.cyan('\\nTo fix invalid files:'));\n        console.log(chalk.gray('  ultrathink sync --fix'));\n      }\n\n    } catch (error) {\n      spinner.fail(chalk.red('Sync failed'));\n      console.error(chalk.red('Error:'), error instanceof Error ? error.message : error);\n      if (options.parent?.opts().debug) {\n        console.error(error);\n      }\n      process.exit(1);\n    }\n  });\n\nasync function scanSkillsDirectory(skillsPath: string): Promise<string[]> {\n  const entries = await readdir(skillsPath, { withFileTypes: true });\n\n  return entries\n    .filter(entry => entry.isFile() && entry.name.endsWith('.md'))\n    .filter(entry => !['INDEX.md', 'CLAUDE.md', 'README.md'].includes(entry.name))\n    .map(entry => resolve(skillsPath, entry.name));\n}\n\nasync function parseSkillFile(filePath: string): Promise<SkillFile> {\n  const content = await readFile(filePath, 'utf-8');\n  const name = basename(filePath, '.md');\n\n  const errors: string[] = [];\n  let metadata: SkillMetadata = {\n    name,\n    type: 'unknown',\n    enabled: true\n  };\n\n  try {\n    // Extract YAML frontmatter\n    const frontmatterMatch = content.match(/^---\\n([\\s\\S]*?)\\n---/);\n\n    if (!frontmatterMatch) {\n      errors.push('Missing YAML frontmatter');\n      return { path: filePath, name, metadata, valid: false, errors };\n    }\n\n    const yamlContent = frontmatterMatch[1];\n\n    // Parse YAML (simple parsing, could use a library)\n    const lines = yamlContent.split('\\n');\n    for (const line of lines) {\n      const match = line.match(/^(\\w+):\\s*(.+)$/);\n      if (match) {\n        const [, key, value] = match;\n        metadata[key] = parseYamlValue(value);\n      }\n    }\n\n    // Validate required fields\n    if (!metadata.name) {\n      errors.push('Missing required field: name');\n    }\n    if (!metadata.type) {\n      errors.push('Missing required field: type');\n    }\n\n    // Validate enabled field\n    if (metadata.enabled !== true && metadata.enabled !== false) {\n      errors.push('Invalid enabled field: must be true or false');\n    }\n\n  } catch (error) {\n    errors.push(`Parse error: ${error instanceof Error ? error.message : error}`);\n  }\n\n  return {\n    path: filePath,\n    name,\n    metadata,\n    valid: errors.length === 0,\n    errors\n  };\n}\n\nfunction parseYamlValue(value: string): any {\n  const trimmed = value.trim();\n\n  if (trimmed === 'true') return true;\n  if (trimmed === 'false') return false;\n  if (trimmed === 'null') return null;\n  if (/^\\d+$/.test(trimmed)) return parseInt(trimmed, 10);\n  if (/^\\d+\\.\\d+$/.test(trimmed)) return parseFloat(trimmed);\n\n  // Remove quotes if present\n  if ((trimmed.startsWith('\"') && trimmed.endsWith('\"')) ||\n      (trimmed.startsWith(\"'\") && trimmed.endsWith(\"'\"))) {\n    return trimmed.slice(1, -1);\n  }\n\n  return trimmed;\n}\n\nasync function fixSkillFile(filePath: string): Promise<void> {\n  const content = await readFile(filePath, 'utf-8');\n  const name = basename(filePath, '.md');\n\n  // Remove existing frontmatter if malformed\n  const withoutFrontmatter = content.replace(/^---\\n[\\s\\S]*?\\n---\\n/, '');\n\n  // Generate valid frontmatter\n  const frontmatter = `---\nname: ${name}\ntype: mcp\nenabled: true\nfixed_at: ${new Date().toISOString()}\n---\n\n`;\n\n  await writeFile(filePath, frontmatter + withoutFrontmatter, 'utf-8');\n}\n\nasync function findOrphanedEntries(skillsPath: string, validSkills: SkillFile[]): Promise<string[]> {\n  const indexPath = resolve(skillsPath, 'INDEX.md');\n\n  if (!existsSync(indexPath)) {\n    return [];\n  }\n\n  const indexContent = await readFile(indexPath, 'utf-8');\n  const validNames = new Set(validSkills.map(s => s.name));\n  const orphaned: string[] = [];\n\n  // Find entries in INDEX.md that don't have corresponding files\n  const entryPattern = /- \\*\\*([^*]+)\\*\\*/g;\n  let match;\n\n  while ((match = entryPattern.exec(indexContent)) !== null) {\n    const entryName = match[1];\n    if (!validNames.has(entryName)) {\n      orphaned.push(entryName);\n    }\n  }\n\n  return orphaned;\n}\n\nasync function updateIndex(skillsPath: string, skills: SkillFile[], orphaned: string[]): Promise<void> {\n  const indexPath = resolve(skillsPath, 'INDEX.md');\n\n  const byType = skills.reduce((acc, skill) => {\n    const type = skill.metadata.type || 'unknown';\n    if (!acc[type]) acc[type] = [];\n    acc[type].push(skill);\n    return acc;\n  }, {} as Record<string, SkillFile[]>);\n\n  let content = `# Skills Index\n\n**Last Updated:** ${new Date().toISOString()}\n**Total Skills:** ${skills.length}\n\n## Skills by Type\n\n`;\n\n  for (const [type, typeSkills] of Object.entries(byType)) {\n    content += `\\n### ${type.toUpperCase()} (${typeSkills.length})\\n\\n`;\n    for (const skill of typeSkills) {\n      const status = skill.metadata.enabled ? '✓ Enabled' : '✗ Disabled';\n      const desc = skill.metadata.description ? ` - ${skill.metadata.description}` : '';\n      content += `- **${skill.name}** (${status})${desc}\\n`;\n    }\n  }\n\n  if (orphaned.length > 0) {\n    content += `\\n## ⚠️ Orphaned Entries\\n\\n`;\n    content += `These entries were in the index but no skill file was found:\\n\\n`;\n    orphaned.forEach(name => {\n      content += `- ${name}\\n`;\n    });\n  }\n\n  content += `\\n## Statistics\n\n- **Total Skills:** ${skills.length}\n- **Active:** ${skills.filter(s => s.metadata.enabled).length}\n- **Inactive:** ${skills.filter(s => !s.metadata.enabled).length}\n- **Types:** ${Object.keys(byType).length}\n\n## Commands\n\n\\`\\`\\`bash\nultrathink sync              # Sync this index\nultrathink import            # Import new MCPs\nultrathink detect-mcp        # Detect available servers\n\\`\\`\\`\n\n---\n*Auto-generated by \\`ultrathink sync\\`*\n`;\n\n  await writeFile(indexPath, content, 'utf-8');\n}\n\nasync function updateClaudeConfig(skillsPath: string, skills: SkillFile[]): Promise<void> {\n  const claudePath = resolve(skillsPath, 'CLAUDE.md');\n\n  const enabledSkills = skills.filter(s => s.metadata.enabled);\n\n  const content = `# Claude Code Skills Configuration\n\n**Skills Directory:** \\`${skillsPath}\\`\n**Active Skills:** ${enabledSkills.length}/${skills.length}\n\n## Enabled Skills\n\n${enabledSkills.map(s => `- **${s.name}** (${s.metadata.type})`).join('\\n')}\n\n## How It Works\n\nSkills in this directory provide Claude Code with:\n\n- **MCP Server Integrations** - Access to external tools and APIs\n- **Project-Specific Configuration** - Tailored to your needs\n- **Version Control** - Track changes to your tooling\n- **Team Collaboration** - Share configurations with your team\n\n## Management\n\n\\`\\`\\`bash\n# Sync skills index\nultrathink sync\n\n# Import from global settings\nultrathink import\n\n# Discover AI experts\nultrathink discover --project ./\n\n# Detect available MCPs\nultrathink detect-mcp\n\n# View this file\ncat skills/CLAUDE.md\n\\`\\`\\`\n\n## Enabling/Disabling Skills\n\nTo disable a skill:\n1. Edit the skill's \\`.md\\` file\n2. Change \\`enabled: true\\` to \\`enabled: false\\`\n3. Run \\`ultrathink sync\\`\n\nTo enable a skill:\n1. Edit the skill's \\`.md\\` file\n2. Change \\`enabled: false\\` to \\`enabled: true\\`\n3. Run \\`ultrathink sync\\`\n\n---\n*Last synced: ${new Date().toISOString()}*\n`;\n\n  await writeFile(claudePath, content, 'utf-8');\n}\n"]}